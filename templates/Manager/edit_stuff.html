{% extends 'Manager/manager_index_base.html' %}
{% block main %}
    {% load filters %}
    <div class="wrapper wrapper-content animated fadeInRight">
                <div class="row">
                    <div class="col-lg-12">
                         <div class="ibox ">
                    <div class="ibox-title">
                        <h5>All stuff</h5>
                        <div class="ibox-tools">
                            <a class="collapse-link">
                                <i class="fa fa-chevron-up"></i>
                            </a>
                            <a class="close-link">
                                <i class="fa fa-times"></i>
                            </a>
                        </div>
                    </div>
                    <div class="ibox-content">

                        <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover dataTables-example" >
                    <thead>
                    <tr>
                        <th>编号</th>
                        <th>密码</th>
                        <th>姓名</th>
                        <th>性别</th>
                        <th>年龄</th>
                        <th>民族</th>
                        <th>学历</th>
                        <th>地址</th>
                        <th>联系方法</th>
                        <th>职位</th>
                        <th>是否管理员</th>
                        <th>操作</th>
                    </tr>
                    </thead>
                        <tbody>
                        {% for item in res %}
                            <tr>
                                <td>{{ item.num }}</td>
                                <td>{{ item.password }}</td>
                                <td>{{ item.name }}</td>
                                <td>{{ item.gender }}</td>
                                <td>{{ item.age }}</td>
                                <td>{{ item.ethnic_groups }}</td>
                                <td>{{ item.edu }}</td>
                                <td>{{ item.address }}</td>
                                <td>{{ item.tele }}</td>
                                <td>{{ item.position }}</td>
                                {% if item.Is_manage == True %}
                                    <td>
                                        <span style="color: green">管理员</span>
                                    </td>
                                {% else %}
                                    <td>
                                        <span style="color: gray;" type="button">非管理员</span>
                                    </td>
                                {% endif %}
                                <td>
                                    <a id="startmodal" data-toggle="modal" data-target="#Modal" href="#"
                                        onclick="values('{{ item.num }}','{{ item.password }}','{{ item.name }}','{{ item.gender }}','{{ item.age }}','{{ item.ethnic_groups }}'
                                                ,'{{ item.edu }}','{{ item.address }}','{{ item.tele }}','{{ item.position }}','{{ item.gender }}','{{ item.Is_manage }}')">修改</a>

                                    <div class="modal fade" id="Modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="exampleModalLabel">修改信息</h5>
                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                          <span aria-hidden="true">&times;</span>
                                                        </button>
                                                </div>
                                                <div class="modal-body">
                                                    <div class="row">
                                                        <div class="col-md-11 order-md-1 offset-md-1">
                                                            <div class="row">
                                                                <div class="col-lg-3">
                                                                    <label for="lastName">编号</label>
                                                                    <input disabled="" name="num" type="text" class="form-control" id="num" value="{{ item.num }}" required="">
                                                                    <div class="invalid-feedback">
                                                                        Valid Name is required.
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-4">
                                                                    <label for="lastName">姓名</label>
                                                                    <input  name="name" type="text" class="form-control" id="name" value="{{ item.name }}" required="">
                                                                    <div class="invalid-feedback">
                                                                         Valid Name is required.
                                                                     </div>
                                                                </div>
                                                                <div class="col-lg-3">
                                                                    <label for="lastName">性别</label>
                                                                    <input  name="gender" type="text" class="form-control" id="gender" value="{{ item.gender }}" required="">
                                                                    <div class="invalid-feedback">
                                                                         Valid Name is required.
                                                                     </div>
                                                                </div>
                                                            </div>
                                                            <div class="row" style="margin-top: 10px">
                                                                <div class="col-lg-5">
                                                                    <label>密码</label>
                                                                    <input  name="password" type="text" class="form-control" id="password" value="{{ item.password }}" required="">
                                                                    <div class="invalid-feedback">
                                                                        Valid Name is required.
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-5">
                                                                    <label for="lastName">是否管理员(输入y或n）</label>
                                                                    <input  name="Is_manage" type="text" class="form-control" id="Is_manage" value="{{ item.Is_manage }}" required="">
                                                                    <div class="invalid-feedback">
                                                                         Valid Name is required.
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row" style="margin-top: 10px">
                                                                <div class="col-lg-5">
                                                                    <label>年龄</label>
                                                                    <input  name="age" type="text" class="form-control" id="age" value="{{ item.age }}" required="">
                                                                    <div class="invalid-feedback">
                                                                        Valid Name is required.
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-5">
                                                                    <label for="lastName">学历</label>
                                                                    <input  name="edu" type="text" class="form-control" id="edu" value="{{ item.edu }}" required="">
                                                                    <div class="invalid-feedback">
                                                                         Valid Name is required.
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row" style="margin-top: 10px">
                                                                <div class="col-lg-5">
                                                                    <label>民族</label>
                                                                    <input name="ethnic_groups" type="text" class="form-control" id="ethnic_groups" required="">
                                                                    <div class="invalid-feedback">
                                                                        Valid Name is required.
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-5">
                                                                    <label for="lastName">职位</label>
                                                                    <input name="position" type="text" class="form-control" id="position" required="">
                                                                    <div class="invalid-feedback">
                                                                         Valid Name is required.
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row col-md-11" style="margin-top: 10px">
                                                                <label>地址</label>
                                                                <input name="address" type="text" class="form-control" id="address">
                                                                <div class="invalid-feedback">
                                                                  Valid Name is required.
                                                                </div>
                                                            </div>
                                                            <div class="row col-md-11" style="margin-top: 10px">
                                                                <label>联系方式</label>
                                                                <input name="tele" type="text" class="form-control" id="tele">
                                                                <div class="invalid-feedback">
                                                                  Valid Name is required.
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>


                                              <div class="modal-footer">
                                                  <span id="tip"> </span>
                                                <button id="close_form" type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                <button id="save_form" type="button" class="btn btn-primary">Save changes</button>
                                              </div>
                                            </div>
                                        </div>
                                    </div>

                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    <tfoot>
                    <tr>
                        <th>编号</th>
                        <th>密码</th>
                        <th>姓名</th>
                        <th>性别</th>
                        <th>年龄</th>
                        <th>民族</th>
                        <th>学历</th>
                        <th>地址</th>
                        <th>联系方法</th>
                        <th>职位</th>
                        <th>是否管理员</th>
                        <th>操作</th>
                    </tr>
                    </tfoot>
                    </table>
                        </div>

                    </div>
                        </div>
                    </div>
                </div>
    </div>
    {% include 'Manager/page.html' %}
    <script type="text/javascript">

        $(function(){
            $('#Modal').modal("hide");
            });
        function values(v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12){
            $('#num').val(v1);
            $('#password').val(v2);
            $('#name').val(v3);
            $('#gender').val(v4);
            $('#age').val(v5);
            $('#ethnic_groups').val(v6);
            $('#edu').val(v7);
            $('#address').val(v8);
            $('#tele').val(v9);
            $('#position').val(v10);
            $('#gender').val(v11);
            $('#Is_manage').val(v12);
        }

        $('#close_form').click(function () {
            $('#num').val("");
            $('#password').val("");
            $('#name').val("");
            $('#gender').val("");
            $('#age').val("");
            $('#ethnic_groups').val("");
            $('#edu').val("");
            $('#address').val("");
            $('#tele').val("");
            $('#position').val("");
            $('#gender').val("");
            $('#Is_manage').val("");
        })
        $('#save_form').click(function () {
            var num = $('#num').val()
            var password = $('#password').val()
            var name = $('#name').val()
            var gender = $('#gender').val()
            var age = $('#age').val()
            var ethnic_groups = $('#ethnic_groups').val()
            var edu = $('#edu').val()
            var address = $('#address').val()
            var tele = $('#tele').val()
            var position = $('#position').val()
            var Is_manage = $('#Is_manage').val()

            $.get('{% url  'Manager:manager_update_stuff'%}',{'num':num,'password':password,'gender':gender,
                'ethnic_groups':ethnic_groups,'address':address,'tele':tele,'name':name,'position':position,
                 'edu':edu,'age':age,'Is_manage':Is_manage},function (data) {
                if (data == 'error'){
                    $('#tip').html("<span style='color:red'>Failure,Check your input</span>")
                }
                else{
                    $('#tip').html("<span style='color:green'>Success</span>")
                    window.location.reload()
                }
            })
    })

    </script>
{% endblock %}